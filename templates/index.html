<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Black Ship | Intelligence Engine</title>

    <!-- Meta Tags -->
    <meta name="description" content="Advanced algorithmic form analysis and tracking system.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom Style -->
    <link rel="stylesheet" href="/static/style.css">
</head>

<body class="view-{{ view }}">
    <!-- Dynamic Background Engine -->
    <div class="void-canvas">
        <div class="aurora-glow"></div>
        <div class="grid-overlay"></div>
    </div>

    <!-- Main Navigation -->
    {% if current_user.is_authenticated %}
    <nav class="cyber-nav">
        <div class="nav-brand">BLACK SHIP</div>
        <div class="nav-menu">
            <a href="{{ url_for('tracker') }}" class="nav-link {% if view == 'tracker' %}active{% endif %}"
                data-tooltip="Hunter">
                <i class="fa-solid fa-satellite-dish"></i>
            </a>
            <div class="nav-divider"></div>
            <a href="{{ url_for('logout') }}" class="nav-link danger" data-tooltip="Disconnect">
                <i class="fa-solid fa-power-off"></i>
            </a>
        </div>
    </nav>
    {% endif %}

    <div class="main-viewport">
        <!-- Hero Header -->
        <header class="cyber-header">
            <h1 class="glitch-text" data-text="BLACK SHIP">BLACK SHIP</h1>
            <div class="status-line">
                <span class="status-dot"></span>
                <p class="status-text">SYSTEM ONLINE // AWAITING INPUT</p>
            </div>
        </header>

        <!-- 1. AUTHENTICATION MODULE -->
        <main id="auth-panel" class="cyber-card panel-view {% if view == 'auth' %}active{% endif %}" data-panel="auth">
            <div class="card-glow"></div>
            <div class="auth-switcher">
                <button class="switch-btn active" id="btnShowLogin">LOGIC</button>
                <button class="switch-btn" id="btnShowRegister">INITIATE</button>
                <div class="switch-slider"></div>
            </div>

            <div id="login-form-box" class="form-container">
                <div class="cyber-input-group">
                    <input type="text" id="loginUser" required>
                    <label>Operative ID</label>
                    <i class="fa-solid fa-hashtag input-icon"></i>
                    <div class="input-line"></div>
                </div>
                <div class="cyber-input-group">
                    <input type="password" id="loginPass" required>
                    <label>Security Key</label>
                    <i class="fa-solid fa-fingerprint input-icon"></i>
                    <div class="input-line"></div>
                </div>
                <button class="cyber-btn primary" id="loginBtn">
                    <span class="btn-text">PROCEED</span>
                    <span class="btn-glitch"></span>
                </button>
            </div>

            <div id="register-form-box" class="form-container hidden">
                <div class="cyber-input-group">
                    <input type="text" id="regUser" required>
                    <label>New Designation</label>
                    <i class="fa-solid fa-plus input-icon"></i>
                    <div class="input-line"></div>
                </div>
                <div class="cyber-input-group">
                    <input type="password" id="regPass" required>
                    <label>Set Passphrase</label>
                    <i class="fa-solid fa-key input-icon"></i>
                    <div class="input-line"></div>
                </div>
                <button class="cyber-btn secondary" id="registerBtn">
                    <span class="btn-text">REGISTER IDENTITY</span>
                    <span class="btn-glitch"></span>
                </button>
            </div>

            <div id="authError" class="cyber-toast error hidden">
                <div class="toast-icon"><i class="fa-solid fa-triangle-exclamation"></i></div>
                <span id="authErrorText">Error...</span>
            </div>
        </main>

        <!-- 2. METHODS MODULE -->
        <main id="methods-panel" class="cyber-card large panel-view {% if view == 'methods' %}active{% endif %}"
            data-panel="methods">
            <div class="card-glow"></div>
            <div class="instructions-panel">
                <div class="hud-label">HOW TO USE BLACK SHIP</div>
                <p class="view-description">Follow these steps to execute your student data analysis.</p>
                <ul class="how-to-list">
                    <li>Paste your <strong>Google Sheet URL</strong> or upload a <strong>Student Manifest</strong>
                        (.csv/.xlsx).</li>
                    <li>Ensure your sheet has a column for student names.</li>
                    <li>Click <strong>START ANALYSIS</strong> to begin the cross-referencing process.</li>
                    <li>Download the final report as an <strong>Excel file</strong> for your records.</li>
                </ul>
                <button class="cyber-btn primary" id="btnToTracker" style="margin-top: 2rem;">
                    <span class="btn-text">ENGAGE ANALYZER</span>
                    <span class="btn-glitch"></span>
                </button>
            </div>
        </main>

        <!-- 3. TRACKER MODULE -->
        <div id="tracker-panel" class="panel-view {% if view == 'tracker' %}active{% endif %}" data-panel="tracker">
            <main id="config-panel" class="cyber-card large">
                <div class="card-glow"></div>

                <div id="errorBanner" class="cyber-toast error hidden">
                    <div class="toast-icon"><i class="fa-solid fa-bug"></i></div>
                    <span id="errorText">System Malfunction</span>
                </div>

                <div class="tracker-panel">
                    <div class="mode-selector">
                        <button class="mode-btn active" id="btnLinkMode">
                            <i class="fa-solid fa-link"></i> NETWORK LINK
                        </button>
                        <button class="mode-btn" id="btnFileMode">
                            <i class="fa-solid fa-database"></i> LOCAL DATA
                        </button>
                    </div>

                    <!-- Mode: Link -->
                    <div id="modeLink" class="input-section">
                        <div class="cyber-input-group large">
                            <input type="text" id="sheetUrl" required placeholder=" ">
                            <label>Target URL Endpoint</label>
                            <i class="fa-solid fa-crosshairs input-icon"></i>
                            <div class="input-line"></div>
                        </div>
                    </div>

                    <!-- Mode: File Upload -->
                    <div id="modeFile" class="input-section hidden">
                        <div class="holo-dropzone" id="dropArea">
                            <div class="drop-content">
                                <i class="fa-solid fa-cloud-arrow-up drop-icon"></i>
                                <h3>UPLOAD FILE</h3>
                                <p>Drag & Drop or Click to Select</p>
                            </div>
                            <input type="file" id="fileInput" class="hidden" accept=".csv, .xlsx, .xls">
                        </div>
                        <div id="filePreview" class="file-manifest hidden">
                            <div class="manifest-icon"><i class="fa-solid fa-file-code"></i></div>
                            <span id="fileName">data.csv</span>
                            <button class="delete-btn" id="removeFile"><i class="fa-solid fa-xmark"></i></button>
                        </div>
                    </div>

                    <button class="cyber-btn action" id="checkBtn">
                        <span class="btn-text">START ANALYSIS</span>
                        <div class="loading-spinner hidden" id="btnSpinner"></div>
                    </button>

                    <div id="loading" class="scan-overlay hidden">
                        <div class="scanner-line"></div>
                        <div class="scanner-text">ANALYZING DATA...</div>
                    </div>
                </div>
            </main>

            <!-- DASHBOARD RESULTS -->
            <section id="results" class="results-dashboard hidden">
                <!-- HUD Stats -->
                <div class="hud-grid">
                    <div class="hud-panel total">
                        <div class="hud-label">TOTAL STUDENTS</div>
                        <div class="hud-value" id="totalCount">0</div>
                        <div class="hud-bar"></div>
                    </div>
                    <div class="hud-panel verified">
                        <div class="hud-label">RESPONDED</div>
                        <div class="hud-value" id="respondedCount">0</div>
                        <div class="hud-bar"></div>
                    </div>
                    <div class="hud-panel missing">
                        <div class="hud-label">NOT RESPONDED</div>
                        <div class="hud-value" id="notRespondedCount">0</div>
                        <div class="hud-bar"></div>
                    </div>
                </div>

                <!-- Data Feeds -->
                <div class="feed-container">
                    <!-- Verified Feed -->
                    <div class="data-feed verified-feed">
                        <div class="feed-header">
                            <h3><i class="fa-solid fa-circle-check"></i> RESPONDED LIST</h3>
                            <span class="feed-badge" id="respondedBadge">0</span>
                        </div>
                        <ul id="respondedUl" class="feed-list"></ul>
                        <button class="feed-action" id="copyResponded">
                            <i class="fa-solid fa-file-excel"></i> DOWNLOAD EXCEL
                        </button>
                    </div>

                    <!-- Missing Feed -->
                    <div class="data-feed missing-feed">
                        <div class="feed-header">
                            <h3><i class="fa-solid fa-circle-xmark"></i> MISSING LIST</h3>
                            <span class="feed-badge" id="notRespondedBadge">0</span>
                        </div>
                        <ul id="notRespondedUl" class="feed-list"></ul>
                        <button class="feed-action" id="copyNotResponded">
                            <i class="fa-solid fa-file-excel"></i> DOWNLOAD EXCEL
                        </button>
                    </div>
                </div>
            </section>
        </div>

    </div>

    <footer class="cyber-footer">
        <div class="footer-line"></div>
        <p>DEVELOPER: <span class="dev-name">KRITHIKA N</span></p>
    </footer>

    <script src="/static/script.js"></script>
</body>

</html>